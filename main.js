var kai = [
    {
        sequence: ["455137", "455138", "455139", "455140", "455141"],
        id: 76848,
        classes: '1-1'
    }, {
        sequence: ["455142", "455143", "455144", "455145"],
        id: 76849,
        classes: '1-2'
    }, {
        sequence: ["455146", "455147"],
        id: 76850,
        classes: '1-3'
    }, {
        sequence: ["455148"],
        id: 76851,
        classes: '1-4'
    }, {
        sequence: ["455149", "455150", "455151"],
        id: 76853,
        classes: '2-1'
    },
    {
        sequence: ["455152", "455153", "455154", "455155"],
        id: 76854,
        classes: '2-2'
    },
    {
        sequence: ["455156", "455157", "455158", "455159"],
        id: 76855,
        classes: '2-3'
    },
    {
        sequence: ["455160"],
        id: 76856,
        classes: '2-4'
    },
    {
        sequence: ["455161", "455162", "455163", "455164"],
        id: 76858,
        classes: '3-1'
    },
    {
        sequence: ["455165", "455166", "455167"],
        id: 76859,
        classes: '3-2'
    },
    {
        sequence: ["455168", "455169", "455170", "455171", "455172", "455173"],
        id: 76860,
        classes: '3-3'
    },
    {
        sequence: ["455174"],
        id: 76860,
        classes: '3-4'
    },
    {
        sequence: ["455175", "455176"],
        id: 76863,
        classes: '4-1'
    },
    {
        sequence: ["455177", "455178", "455179", "455180", "455181"],
        id: 76864,
        classes: '4-2'
    },
    {
        sequence: ["455182", "455183"],
        id: 76865,
        classes: '4-3'
    },
    {
        sequence: ["455184", "455185", "455186", "455187"],
        id: 76866,
        classes: '4-4'
    },
    {
        sequence: ["455188"],
        id: 76867,
        classes: '4-5'
    },
    {
        sequence: ["455189", "455190", "455191", "455192"],
        id: 76869,
        classes: '5-1'
    },
    {
        sequence: ["455193", "455194", "455195", "455196"],
        id: 76870,
        classes: '5-2'
    }, {
        sequence: ["455197", "455198", "455199"],
        id: 76871,
        classes: '5-3'
    }, {
        sequence: ["455200", "455201", "455202", "455203"],
        id: 76872,
        classes: '5-4'
    }, {
        sequence: ["455204"],
        id: 76873,
        classes: '5-5'
    },
    {
        sequence: ["477314", "497703", "497704"],
        id: 76877,
        classes: '6-1'
    }
]
var ren = [
    {
        sequence: ["455137", "455138", "455139", "455140", "455141"],
        id: 76848,
        classes: '1-1'
    }, {
        sequence: ["455142", "455143", "455144", "455145"],
        id: 76849,
        classes: '1-2'
    }, {
        sequence: ["455146", "455147"],
        id: 76850,
        classes: '1-3'
    }, {
        sequence: ["455148"],
        id: 76851,
        classes: '1-4'
    },
    {
        sequence: ["455149", "455150", "455151"],
        id: 76853,
        classes: '2-1'
    },
    {
        sequence: ["455152", "455153", "455154", "455155"],
        id: 76854,
        classes: '2-2'
    },
    {
        sequence: ["455156", "455157", "455158", "455159"],
        id: 76855,
        classes: '2-3'
    },
    {
        sequence: ["455160"],
        id: 76856,
        classes: '2-4'
    },
    {
        sequence: ["455161", "455162", "455163", "455164"],
        id: 76858,
        classes: '3-1'
    },
    {
        sequence: ["455165", "455166", "455167"],
        id: 76859,
        classes: '3-2'
    },
    {
        sequence: ["455168", "455169", "455170", "455171", "455172", "455173"],
        id: 76860,
        classes: '3-3'
    },
    {
        sequence: ["455174"],
        id: 76860,
        classes: '3-4'
    },
    {
        sequence: ["455175", "455176"],
        id: 76863,
        classes: '4-1'
    },
    {
        sequence: ["455177", "455178", "455179", "455180", "455181"],
        id: 76864,
        classes: '4-2'
    },
    {
        sequence: ["455182", "455183"],
        id: 76865,
        classes: '4-3'
    },
    {
        sequence: ["455184", "455185", "455186", "455187"],
        id: 76866,
        classes: '4-4'
    },
    {
        sequence: ["455188"],
        id: 76867,
        classes: '4-5'
    },
    {
        sequence: ["455189", "455190", "455191", "455192"],
        id: 76869,
        classes: '5-1'
    },
    {
        sequence: ["455193", "455194", "455195", "455196"],
        id: 76870,
        classes: '5-2'
    }, {
        sequence: ["455197", "455198", "455199"],
        id: 76871,
        classes: '5-3'
    }, {
        sequence: ["455200", "455201", "455202", "455203"],
        id: 76872,
        classes: '5-4'
    }, {
        sequence: ["455204"],
        id: 76873,
        classes: '5-5'
    },
    {
        sequence: ["477314", "497703", "497704"],
        id: 76877,
        classes: '6-1'
    }
]


var public = [
    {
        sequence: ["490514", "490515", "490516", "490517", "490518"],
        id: 85430,
        classes: '0-1'
    }, {
        sequence: ["490519", "490520", "490521", "490522"],
        id: 85431,
        classes: '0-2'
    },
    {
        sequence: ["490523", "490524", "490525", "490526"],
        id: 85433,
        classes: '1-1'
    },
    {
        sequence: ["490527", "490528", "490529", "490530", "490531", "490532", "490533", "490534", "490535", "490536", "490537", "490538", "490539", "490540"],
        id: 85434,
        classes: '1-2'
    },
    {
        sequence: ["490541", "490542", "490543"],
        id: 85435,
        classes: '1-3'
    },
    {
        sequence: ["490544", "490545"],
        id: 85436,
        classes: '1-4'
    },
    {
        sequence: ["455161", "455162", "455163", "455164"],
        id: 85438,
        classes: '2-1'
    },
    {
        sequence: ["490549", "490550", "490551", "490552", "490553", "490554", "490555", "490556", "490557", "490558", "490559", "490560", "490561", "490562"],
        id: 85439,
        classes: '2-2'
    },
    {
        sequence: ["490563", "490564"],
        id: 85440,
        classes: '2-3'
    },
    {
        sequence: ["490565"],
        id: 85441,
        classes: '2-4'
    },
    {
        sequence: ["490566", "490567", "490568", "490569"],
        id: 85443,
        classes: '3-1'
    },
    {
        sequence: ["490570", "490571", "490572", "490573", "490574", "490575", "490576"],
        id: 85444,
        classes: '3-2'
    },
    {
        sequence: ["490577", "490578", "490579"],
        id: 85445,
        classes: '3-3'
    },
    {
        sequence: ["490580"],
        id: 85446,
        classes: '3-4'
    },
    {
        sequence: ["455189", "455190", "455191", "455192"],
        id: 85448,
        classes: '4-1'
    },
    {
        sequence: ["490584", "490585", "490586", "490587", "490588", "490589", "490590", "490591", "490592", "490593", "490594", "490595", "490596", "490597", "490598"],
        id: 85449,
        classes: '4-2'
    }, {
        sequence: ["490599", "490600", "490601"],
        id: 85450,
        classes: '4-3'
    }, {
        sequence: ["490602"],
        id: 85451,
        classes: '4-4'
    },
    {
        sequence: ["490604", "490605", "490606", "490607"],
        id: 85454,
        classes: '5-1'
    },
    {
        sequence: ["490608", "490609", "490610", "490611", "490612", "490613", "490614", "490615", "490616", "490617", "490618", "490619", "490620", "490621"],
        id: 85455,
        classes: '5-2'
    },
    {
        sequence: ["490622", "490623", "490624"],
        id: 85456,
        classes: '5-3'
    },
    {
        sequence: ["490625", "490626"],
        id: 85457,
        classes: '5-4'
    },
    {
        sequence: ["490627", "490628", "490629", "490630"],
        id: 85459,
        classes: '6-1'
    },
    {
        sequence: ["490631", "490632", "490633", "490634", "490635", "490636", "490637", "490638", "490639", "490640", "490641", "490642", "490643", "490644", "490645", "490646"],
        id: 85460,
        classes: '6-2'
    },
    {
        sequence: ["490647", "490648", "490649", "490650"],
        id: 85461,
        classes: '6-3'
    },
    {
        sequence: ["490651", "490652"],
        id: 85462,
        classes: '6-4'
    },
    {
        sequence: ["490653", "490654", "490655", "490656"],
        id: 85464,
        classes: '7-1'
    },
    {
        sequence: ["490657", "490658", "490659", "490660", "490661", "490662", "490663", "490664", "490665", "490666", "490667", "490668", "490669"],
        id: 85465,
        classes: '7-2'
    },
    {
        sequence: ["490670", "490671"],
        id: 85466,
        classes: '7-3'
    },
    {
        sequence: ["490672", "490673"],
        id: 85467,
        classes: '7-4'
    },
    {
        sequence: ["490674", "490675", "490676"],
        id: 85469,
        classes: '8-1'
    },
    {
        sequence: ["490677", "490678", "490679", "490680", "490681", "490682", "490683", "490684", "490685", "490686", "490687", "490688", "490689", "490696", "490691", "490692", "490693", "490694", "490695", "490696"],
        id: 85470,
        classes: '8-2'
    },
    {
        sequence: ["490697", "490698", "490699"],
        id: 85471,
        classes: '8-3'
    },
    {
        sequence: ["490700"],
        id: 85472,
        classes: '8-4'
    },
    {
        sequence: ["490702", "490703", "490704"],
        id: 85475,
        classes: '9-1'
    },
    {
        sequence: ["490705", "490706", "490707", "490708", "490709", "490710", "490711", "490712", "490713"],
        id: 85476,
        classes: '9-2'
    },
    {
        sequence: ["490714", "490715"],
        id: 85477,
        classes: '9-3'
    },
    {
        sequence: ["490716", "490717"],
        id: 85478,
        classes: '9-4'
    },
    {
        sequence: ["490718", "490719", "490720"],
        id: 85480,
        classes: '10-1'
    },
    {
        sequence: ["490721", "490722", "490723", "490724", "490725", "490726", "490727", "490728", "490729", "490730", "490731", "490732", "490733", "490734", "490735", "490736"],
        id: 85481,
        classes: '10-2'
    },
    {
        sequence: ["490737", "490738", "490739"],
        id: 85482,
        classes: '10-3'
    },
    {
        sequence: ["490740"],
        id: 85483,
        classes: '10-4'
    },
    {
        sequence: ["490741", "490742", "490743", "490744"],
        id: 85485,
        classes: '11-1'
    }, {
        sequence: ["490745", "490746", "490747", "490748"],
        id: 85486,
        classes: '11-2'
    }, {
        sequence: ["490749", "490750"],
        id: 85487,
        classes: '11-3'
    }, {
        sequence: ["490751"],
        id: 85488,
        classes: '11-4'
    }, {
        sequence: ["490672", "490673"],
        id: 85490,
        classes: '12-1'
    }, {
        sequence: ["490755", "490756", "490757", "490758", "490759", "490760", "490761"],
        id: 85491,
        classes: '12-2'
    }, {
        sequence: ["490762", "490763", "490764"],
        id: 85492,
        classes: '12-3'
    }, {
        sequence: ["490765", "490766"],
        id: 85493,
        classes: '12-4'
    }, {
        sequence: ["490603", "490701", "490767", "490768", "490769", "490770", "490771", "490772", "490773", "490774", "490775", "490776"],
        id: 85496,
        classes: '形考作业与模拟测试'
    }, {
        sequence: ["490777", "490778", "490779", "490780", "490781", "490782", "490783", "490784", "490785", "490786", "490787", "490788", "490789", "490790"],
        id: 85498,
        classes: '案例讲授-1'
    }, {
        sequence: ["490791", "490792", "490793", "490794", "490795", "490796"],
        id: 85499,
        classes: '案例讲授-2'
    }, {
        sequence: ["490797", "490798", "490799", "490800", "490801", "490802", "490803", "490804", "490805", "490806"],
        id: 85500,
        classes: '案例讲授-3'
    }, {
        sequence: ["490807", "490808", "490809", "490810", "490811", "490812", "490813", "490814", "490815", "490816", "490817", "490818", "490819", "490820", "490821", "490822", "490823", "490824", "490825", "490826", "490827", "490828", ],
        id: 85502,
        classes: '课程资源-1'
    }, {
        sequence: ["490829", "490830"],
        id: 85503,
        classes: '课程资源-2'
    }, {
        sequence: ["490831", "490832", "497878", "499284"],
        id: 85504,
        classes: '课程资源-3'
    }, {
        sequence: ["490839"],
        id: 85507,
        classes: '支持服务'
    }
]


var kuai = [
    {
        sequence: ["457467", "457468", "457469", "457470", "457471", "457472"],
        id: 77318,
        classes: '0-1'
    }, {
        sequence: ["457473", "457474", "457475"],
        id: 77319,
        classes: '0-2'
    }, {
        sequence: ["457476", "457477", "457478", "457479", "457480", "457481", "457482"],
        id: 77321,
        classes: '1-1'
    }, {
        sequence: ["457483", "457484", "457485", "457486", "457487"],
        id: 77322,
        classes: '1-2'
    }, {
        sequence: ["457488", "457489", "457490", "457491", "457492", "457493", "457494", "457495", "457496", "457497"],
        id: 77323,
        classes: '1-3'
    }, {
        sequence: ["457498", "457499"],
        id: 77324,
        classes: '1-4'
    },
    {
        sequence: ["457500", "457501", "457502", "457503"],
        id: 77326,
        classes: '2-1'
    },
    {
        sequence: ["457504", "457505", "457506", "457507", "457508", "457509", "457510"],
        id: 77327,
        classes: '2-2'
    },
    {
        sequence: ["457511", "457512", "457513", "457514", "457515", "457516"],
        id: 77328,
        classes: '2-3'
    },
    {
        sequence: ["457517"],
        id: 77329,
        classes: '2-4'
    },
    {
        sequence: ["457518"],
        id: 77330,
        classes: '2-5'
    },
    {
        sequence: ["457522", "457523", "457524", "457525", "457526"],
        id: 77333,
        classes: '3-1'
    },
    {
        sequence: ["457527", "457528", "457529"],
        id: 77334,
        classes: '3-2'
    },
    {
        sequence: ["457530", "457531", "457532", "457533", "457534", "457535", "457536", "457537", "457538", "457539", "457540", "457541", "457542", ],
        id: 77335,
        classes: '3-3'
    },
    {
        sequence: ["457543", "457544"],
        id: 77336,
        classes: '3-4'
    },
    {
        sequence: ["457545", "457546", "457547"],
        id: 77337,
        classes: '3-5'
    },
    {
        sequence: ["457548", "457549"],
        id: 77339,
        classes: '4-1'
    },
    {
        sequence: ["457550", "457551", "457552", "457553"],
        id: 77340,
        classes: '4-2'
    },
    {
        sequence: ["457554", "457555", "457556", "457557"],
        id: 77341,
        classes: '4-3'
    },
    {
        sequence: ["457558", "457559", "457560", "457561", "457562", "457563", "457564", "457565"],
        id: 77342,
        classes: '4-4'
    },
    {
        sequence: ["457566", "457567", "457568", "457569"],
        id: 77343,
        classes: '4-5'
    },
    {
        sequence: ["457570", "457571", "457572", "457573"],
        id: 77344,
        classes: '4-6'
    }, {
        sequence: ["457574", "457575", "457576"],
        id: 77345,
        classes: '4-7'
    },
    {
        sequence: ["457577", "457578"],
        id: 77347,
        classes: '5-1'
    },
    {
        sequence: ["457579", "457580", "457581", "457582", "457583", "457584", "457585", "457586"],
        id: 77348,
        classes: '5-2'
    }, {
        sequence: ["457587", "457588", "457589", "457590", "457591", "457592", "457593", "457594", "457595", "457596", "457597", "457598", "457599", "457600", "457601"],
        id: 77349,
        classes: '5-3'
    }, {
        sequence: ["457602", "457603", "457604"],
        id: 77350,
        classes: '5-4'
    }, {
        sequence: ["457605", "457606", "457607", "457608", "457609", "457610", "457611", "457612"],
        id: 77351,
        classes: '5-5'
    }, {
        sequence: ["457613", "457614", "457615"],
        id: 77352,
        classes: '5-6'
    }, {
        sequence: ["457616", "457617", "457618"],
        id: 77353,
        classes: '5-7'
    },
    {
        sequence: ["457619", "457620", "457621", "457622", "457623", "457624", "457625", "457626", "457627", "457628", "457629", "457630", "457631", "457632"],
        id: 77355,
        classes: '6-1'
    },
    {
        sequence: ["457633", "457634", "457635", "457636", "457637", "457638", "457639", "457640", "457641", "457642", "457643", "457644", "457645"],
        id: 77356,
        classes: '6-2'
    },
    {
        sequence: ["457646", "457647", "457648", "457649", "457650", "457651", "457652", "457653", "457654"],
        id: 77357,
        classes: '6-3'
    },
    {
        sequence: ["457655", "457656", "457657", "457658"],
        id: 77358,
        classes: '6-4'
    }, {
        sequence: ["457659", "457660", "457661"],
        id: 77359,
        classes: '6-5'
    },
    {
        sequence: ["457662", "457663", "457664", "457665", "457666", "457667", "457668"],
        id: 77361,
        classes: '7-1'
    },
    {
        sequence: ["457669", "457670", "457671", "457672", "457673", "457674", "457675", "457676", "457677"],
        id: 77362,
        classes: '7-2'
    },
    {
        sequence: ["457678", "457679", "457680", "457681", "457682", "457683"],
        id: 77363,
        classes: '7-3'
    },
    {
        sequence: ["457684", "457685", "457686"],
        id: 77364,
        classes: '7-4'
    }, {
        sequence: ["457687", "457688", "457689"],
        id: 77366,
        classes: '8-1'
    }, {
        sequence: ["457690", "457691"],
        id: 77367,
        classes: '8-2'
    }, {
        sequence: ["457692", "457693"],
        id: 77368,
        classes: '8-3'
    }, {
        sequence: ["457694"],
        id: 77369,
        classes: '8-4'
    }, {
        sequence: ["457695", "457696", "457697"],
        id: 77370,
        classes: '8-5'
    },
    {
        sequence: ["457702", "457703", "457704", "457705", "457706", "457707"],
        id: 77373,
        classes: '9-1'
    }, {
        sequence: ["457708", "457709"],
        id: 77374,
        classes: '9-2'
    }, {
        sequence: ["457710", "457711"],
        id: 77375,
        classes: '9-3'
    },
    {
        sequence: ["495389", "497969", "498210", "498211", "499471"],
        id: 77377,
        classes: '10-1'
    }, {
        sequence: ["457712"],
        name: '支持服务',
        id: 77378,
    }
]

var phantom = require('phantom')

function getClass(obj, id) {
    var list = []
    obj.forEach(res => {
        res.sequence.forEach(x => {
            list.push(`http://guangzhou.ouchn.cn/course/view.php?id=${id}&sectionid=${res.id}&mid=${x}`)
            // 3798 ---> 基础会计
            // 3789 --->国家开放大学学习指南
            // 3928 ---> 公共关系学
        })
    })

    var len = list.length - 1
    var i = -1
    var timer = setInterval(() => {
        i++
        getPic(list[i])
        // openNew(list[i], 'pps')
        // if (win_Array.length > 2) {
        //     if (i < 2) {
        //         return false
        //     } else {
        //         win_Array[i - 2].close();
        //     }
        // }
        if (i === len) clearInterval(timer)
    }, 6000)

}

var win_Array = new Array();
var win_num = -1;

function openNew(uri, param) {
    win_num = win_num + 1;
    win_Array[win_num] = window.open(uri);
}


var getPic = async (url) => {
    var instance = await phantom.create();
    //创建一个页面
    var page = await instance.createPage();
    //设置页面参数
    await page.property('viewportSize', { width: 100, height: 100 });
    //打开url，返回状态（url有转码，解决中文问题）
    var status = await page.open(encodeURI(url));
    console.log(status);
    //延时等待页面js执行完成（phantomjs只是等待页面上全部资源加载完毕，不包含页面js执行时间，所以需延时一段时间等待js）
    await lateTime(500);
    //输出页面到当前目录下
    //销毁实例
    await instance.exit();
};

var lateTime = (time) => {
    return new Promise(function(resolve, reject) {
        setTimeout(function() {
            resolve();
        }, time);
    });
}



// getClass(public, 3928)
// getPic('https://www.baidu.com/')